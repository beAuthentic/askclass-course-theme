<div class="logo-static">
  <div class="progress-wrapper">
    <!-- SVG ring – sized to match the img -->
    <svg class="progress-ring" viewBox="0 0 100 100" aria-hidden="true">
      <circle class="progress-ring__bar"   cx="50" cy="50" r="48"/>
    </svg>
    <a href="/">
      <img src="/assets/{{ include.image | default: site.acc.logo.image }}"
        title="{{ site.title }}" />
    </a>
  </div>
  <a class="logo-name" href="/segment/{{ session_data.segment }}">{{ site.acc.short_name }}</a>
</div>

<script defer>
  const e = document.querySelector('div.logo-static');
  const bar = document.querySelector('.progress-ring__bar');

  const circumference = 2 * Math.PI * 48; // ≈ 301.59 – matches r="48"
  bar.style.strokeDasharray = circumference;

  function updateProgress() {
    const scrollTop = window.scrollY;
    const scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
    let percent = scrollHeight > 0 ? (scrollTop / scrollHeight) * 100 : 0;
    percent = Math.min(100, Math.max(0, percent));

    const offset = circumference * (1 - percent / 100);
    bar.style.strokeDashoffset = offset;
  }

  window.onscroll = () => {
    const top = window.pageYOffset;
    if (window.innerHeight + top >= document.body.offsetHeight - 2) {
      e.classList.add('bottom');
    } else if (top > 100) {
      e.classList.remove('bottom');
      e.classList.add('fixed');
    } else {
      e.classList.remove('fixed');
    }
    updateProgress();
  }
</script>
